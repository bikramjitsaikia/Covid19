<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>All Users - Covid 19 India</title>
	<link rel="stylesheet" type="text/css"
		href="webjars/bootstrap/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css"
		href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">
	<link rel="stylesheet" type="text/css"
		href="https://cdn.datatables.net/select/1.3.3/css/select.dataTables.min.css">
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/data.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>

</head>
<body class="bg-dark">
	<div th:replace="~{nav_fragments/user_nav :: user_nav}"></div>

	<div class="container">
		<div class="row align-items-center pb-5">
			<div class="col" id="ts-active">
			</div>
			<div class="col" id="ts-recovered">
			</div>
		</div>
		<div class="row align-items-center pb-5">
			<div class="col" id="ts-deaths">
			</div>
			<div class="col" id="ts-total">
			</div>
		</div>
	</div>
	<script th:inline="javascript">
		$(document).ready(function () {            
	        var chartVal = {
		 		backgroundColor: ' #201818 ',
	                zoomType: 'x'
	        };
	        var xaxis = {
	                type: 'datetime',
                    labels: {
			            style: {
            			    color: 'white'
            			}
        			}	                
	        };
	        var yaxis = {
	                title: {
	                    text: ''
	                },
                    labels: {
			            style: {
            			    color: 'white'
            			}
        			}	               
	            };
		    function plotVals(color) {
		        var plotStr = {
	                area: {
	                    fillColor: {
	                        linearGradient: {
	                            x1: 0,
	                            y1: 0,
	                            x2: 0,
	                            y2: 1
	                        },
	                        stops: [
	                            [0, color],
	                            [1, Highcharts.color(color).setOpacity(0).get('rgba')]
	                        ]
	                    },
	                    marker: {
	                        radius: 2
	                    },
	                    lineWidth: 1,
	                    states: {
	                        hover: {
	                            lineWidth: 1
	                        }
	                    },
	                    threshold: null
	                }
			    };
		        return plotStr;
		    }
	        Highcharts.chart('ts-active', {
	            chart: chartVal,
	            title: {
	                text: 'Daily active cases',
	                style: {
	                	color: 'white'
                	}
	            },
	            xAxis: xaxis,
	            yAxis: yaxis,
	            legend: {
	                enabled: false
	            },
	            plotOptions: plotVals('#faff33'),
	            series: [{
	                type:	'area',
	                data:	activeData("dailyconfirmed"),
	                color:	'#faff33'
	            }]
	        });
	        
	       	Highcharts.chart('ts-recovered', {
	            chart: chartVal,
	            title: {
	                text: 'Daily recovered cases',
	                style: {
	                	color: 'white'
                	}
	            },
	            xAxis: xaxis,
	            yAxis: yaxis,
	            legend: {
	                enabled: false
	            },
	            plotOptions: plotVals('#33ff33'),	
	            series: [{
	                type: 'area',
	                data:    activeData("dailyrecovered"),
	                color: 'green' 
	            }]
	        });
	        
	       	Highcharts.chart('ts-deaths', {
	            chart: chartVal,
	            title: {
	                text: 'Daily death cases',
	                style: {
	                	color: 'white'
                	}
	            },
	            xAxis: xaxis,
	            yAxis: yaxis,
	            legend: {
	                enabled: false
	            },
	            plotOptions: plotVals('#ff4b33'),	
	            series: [{
	                type: 'area',
	                name: 'Total death cases',
	                data:    activeData("dailydeceased"), 
	            }]
	        });

	       	Highcharts.chart('ts-total', {
	            chart: chartVal,
	            title: {
	                text: 'Daily death cases',
	                style: {
	                	color: 'white'
                	}
	            },
	            xAxis: xaxis,
	            yAxis: yaxis,
	            legend: {
	                enabled: false
	            },
	            plotOptions: plotVals('white'),	
	            series: [{
	                type: 'area',
	                name: 'Total new cases',
	                data:    activeData("totalconfirmed"), 
	            }]
	        });
	    });
		function activeData(index) {
			var dataForDays = 90;
			var activeCases = [];
			var i = 0;
			var data = /*[[${series_data}]]*/ null;
			if (data == null)
				return null;
			dataLength = data.length;
		    for (i = dataLength-dataForDays; i < dataLength; i += 1) {
		    	activeCases.push([
		    		parseFloat(Date.parse(data[i].date)),
		    		parseFloat(data[i][String(index)]),
		    	]);
			}			
			return activeCases;
		}
    </script>	
</body>
</html>